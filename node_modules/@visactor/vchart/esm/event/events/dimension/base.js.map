{"version":3,"sources":["../src/event/events/dimension/base.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,KAAK,EAAE,MAAM,qBAAqB,CAAC;AAY5C,OAAO,EAAE,qBAAqB,EAAE,MAAM,cAAc,CAAC;AACrD,OAAO,EAAE,yBAAyB,EAAE,uBAAuB,EAAE,MAAM,kBAAkB,CAAC;AAEtF,OAAO,EAAE,UAAU,EAAE,MAAM,kBAAkB,CAAC;AAE9C,MAAM,OAAO,cAAc;IAQzB,YAAY,eAAiC,EAAE,IAAgB;QAC7D,IAAI,CAAC,gBAAgB,GAAG,eAAe,CAAC;QACxC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;IACpB,CAAC;IAED,IAAY,KAAK;;QACf,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YAChB,IAAI,CAAC,MAAM,GAAG,MAAA,MAAA,IAAI,CAAC,gBAAgB,CAAC,cAAc,EAAC,QAAQ,kDAAI,CAAC;SACjE;QACD,OAAO,IAAI,CAAC,MAAM,CAAC;IACrB,CAAC;IAED,QAAQ,CAAqB,KAAU,EAAE,OAAiD;;QACxF,CAAC,MAAA,MAAA,IAAI,CAAC,KAAK,0CAAE,SAAS,GAAG,OAAO,mCAAI,KAAK,CAAC,CAAC,yBAAyB,CAAC,CAAC;IACxE,CAAC;IACD,UAAU;;QACR,CAAC,MAAA,MAAA,IAAI,CAAC,KAAK,0CAAE,SAAS,GAAG,OAAO,mCAAI,KAAK,CAAC,CAAC,yBAAyB,CAAC,CAAC;IACxE,CAAC;IAES,sBAAsB,CAAC,CAAS,EAAE,CAAS;;QACnD,MAAM,aAAa,GAAG,MAAA,yBAAyB,CAAC,IAAI,CAAC,KAAK,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,mCAAI,EAAE,CAAC;QAC5E,MAAM,SAAS,GAAG,MAAA,qBAAqB,CAAC,IAAI,CAAC,KAAK,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,mCAAI,EAAE,CAAC;QAEpE,MAAM,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,aAAa,EAAE,SAAS,CAAC,CAAC;QACnD,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;YACvB,OAAO,IAAI,CAAC;SACb;QAED,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,QAAQ,CAAC,CAAU,EAAE,GAA0C;;QAE7D,MAAM,IAAI,GAAG,MAAA,IAAI,CAAC,KAAK,0CAAE,gBAAgB,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE;YACrD,IAAI,CAAC,CAAC,OAAO,KAAK,MAAM,EAAE;gBACxB,OAAO,KAAK,CAAC;aACd;YACD,MAAM,KAAK,GAAW,CAAE,CAAC,QAAQ,EAAE,CAAC;YACpC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;gBAC3B,OAAO,KAAK,CAAC;aACd;YACD,IAAI,GAAG,aAAH,GAAG,uBAAH,GAAG,CAAE,MAAM,EAAE;gBACf,OAAO,GAAG,CAAC,MAAM,CAAQ,CAAC,CAAC,CAAC;aAC7B;YACD,OAAO,IAAI,CAAC;QACd,CAAC,CAAY,CAAC;QACd,MAAM,aAAa,GAAqB,EAAE,CAAC;QAC3C,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;YACf,MAAM,IAAI,GAAG,uBAAuB,CAAC,CAAmB,EAAE,CAAC,CAAC,CAAC;YAC7D,IAAI,IAAI,EAAE;gBACR,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAC1B;QACH,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE;YACxB,MAAM,EAAE,OAAO;YACf,aAAa;SACgB,CAAC,CAAC;QACjC,OAAO,aAAa,CAAC;IACvB,CAAC;CACF","file":"base.js","sourcesContent":["import { error } from '../../../util/debug';\nimport type { IAxis } from '../../../component/axis/interface';\nimport type { RenderMode } from '../../../typings/spec/common';\nimport type {\n  BaseEventParams,\n  EventHandler,\n  EventParamsDefinition,\n  IComposedEvent,\n  IEventDispatcher\n} from '../../interface';\nimport type { IChart } from '../../../chart/interface';\nimport type { IDimensionInfo } from './interface';\nimport { getPolarDimensionInfo } from './util/polar';\nimport { getCartesianDimensionInfo, getDimensionInfoByValue } from './util/cartesian';\nimport type { Maybe } from '../../../typings';\nimport { isDiscrete } from '@visactor/vscale';\n\nexport class DimensionEvent implements IComposedEvent {\n  protected _eventDispatcher: IEventDispatcher;\n  protected _mode: RenderMode;\n\n  protected _callback!: (params: BaseEventParams) => void;\n\n  protected _chart: Maybe<IChart>;\n\n  constructor(eventDispatcher: IEventDispatcher, mode: RenderMode) {\n    this._eventDispatcher = eventDispatcher;\n    this._mode = mode;\n  }\n\n  private get chart() {\n    if (!this._chart) {\n      this._chart = this._eventDispatcher.globalInstance.getChart?.();\n    }\n    return this._chart;\n  }\n\n  register<Evt extends string>(eType: Evt, handler: EventHandler<EventParamsDefinition[Evt]>): void {\n    (this.chart?.getOption().onError ?? error)('Method not implemented.');\n  }\n  unregister(): void {\n    (this.chart?.getOption().onError ?? error)('Method not implemented.');\n  }\n\n  protected getTargetDimensionInfo(x: number, y: number): IDimensionInfo[] | null {\n    const cartesianInfo = getCartesianDimensionInfo(this.chart, { x, y }) ?? [];\n    const polarInfo = getPolarDimensionInfo(this.chart, { x, y }) ?? [];\n\n    const result = [].concat(cartesianInfo, polarInfo);\n    if (result.length === 0) {\n      return null;\n    }\n\n    return result;\n  }\n\n  dispatch(v: unknown, opt: { filter?: (axis: IAxis) => boolean }) {\n    // get all enable axis\n    const axis = this.chart?.getAllComponents().filter(c => {\n      if (c.specKey !== 'axes') {\n        return false;\n      }\n      const scale = (<IAxis>c).getScale();\n      if (!isDiscrete(scale.type)) {\n        return false;\n      }\n      if (opt?.filter) {\n        return opt.filter(<IAxis>c);\n      }\n      return true;\n    }) as IAxis[];\n    const dimensionInfo: IDimensionInfo[] = [];\n    axis.forEach(a => {\n      const info = getDimensionInfoByValue(a as unknown as any, v);\n      if (info) {\n        dimensionInfo.push(info);\n      }\n    });\n    this._callback.call(null, {\n      action: 'enter',\n      dimensionInfo\n    } as unknown as BaseEventParams);\n    return dimensionInfo;\n  }\n}\n"]}