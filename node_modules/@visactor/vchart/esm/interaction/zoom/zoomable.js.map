{"version":3,"sources":["../src/interaction/zoom/zoomable.ts"],"names":[],"mappings":"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","file":"zoomable.js","sourcesContent":["import type { IModelOption } from './../../model/interface';\n/* eslint-disable no-duplicate-imports */\nimport { debounce, isNil, pointInRect, throttle } from '@visactor/vutils';\nimport type { BaseEventParams, EventQuery, EventType, ExtendEventParam, IEvent } from '../../event/interface';\nimport type { IRegion } from '../../region/interface';\nimport type { RenderMode } from '../../typings/spec';\nimport { RenderModeEnum } from '../../typings/spec/common';\nimport { getDefaultTriggerEventByMode } from '../../component/common/trigger/config';\nimport type { IZoomTrigger } from '../../component/common/trigger/interface';\nimport type { ISeries } from '../../series/interface';\nimport { Event_Bubble_Level, Event_Source_Type } from '../../constant';\nimport type { IDelayType } from '../../typings/event';\nimport { isMiniAppLikeMode, isMobileLikeMode } from '../../util';\nimport type { Gesture } from '@visactor/vrender-kits';\n\nconst delayMap = {\n  debounce: debounce,\n  throttle: throttle\n};\n\nexport interface ITriggerOption {\n  delayType: IDelayType;\n  delayTime: number;\n  realTime: boolean;\n}\nexport interface IZoomEventOptions {\n  shouldZoom?: boolean;\n  zoomCallback?: (params: { zoomDelta: number; zoomX: number; zoomY: number }, e: BaseEventParams['event']) => void;\n  shouldScroll?: boolean;\n  scrollCallback?: (params: { scrollX: number; scrollY: number }, e: BaseEventParams['event']) => void;\n}\nexport interface IZoomable {\n  initZoomable: (evt: IEvent, mode?: RenderMode) => void;\n  initZoomEventOfSeries: (\n    s: ISeries,\n    callback?: (params: { zoomDelta: number; zoomX: number; zoomY: number }, e: BaseEventParams['event']) => void\n  ) => any;\n  initZoomEventOfRegions: (\n    regions: IRegion[],\n    filter?: (s: ISeries) => boolean,\n    callback?: (params: { zoomDelta: number; zoomX: number; zoomY: number }, e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) => void;\n\n  initScrollEventOfSeries: (\n    s: ISeries,\n    callback?: (params: { scrollX: number; scrollY: number }, e: BaseEventParams['event']) => void\n  ) => any;\n  initScrollEventOfRegions: (\n    regions: IRegion[],\n    filter?: (s: ISeries) => boolean,\n    callback?: (params: { scrollX: number; scrollY: number }, e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) => void;\n\n  initDragEventOfSeries: (\n    s: ISeries,\n    callback?: (delta: [number, number], e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) => any;\n\n  initDragEventOfRegions: (\n    regions: IRegion[],\n    filter?: (s: ISeries) => boolean,\n    callback?: (delta: [number, number], e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) => void;\n}\n\nexport class Zoomable implements IZoomable {\n  private _clickEnable: boolean;\n\n  private _option: IModelOption;\n\n  private _zoomableTrigger: IZoomTrigger;\n\n  private _eventObj: IEvent;\n\n  private _renderMode: RenderMode;\n\n  private _gestureController!: Gesture | null;\n\n  private _isGestureListener: boolean = false;\n\n  initZoomable(evt: IEvent, mode: RenderMode = RenderModeEnum['desktop-browser']) {\n    this._eventObj = evt;\n    this._renderMode = mode;\n    this._gestureController = (this._option.getChart().getVGrammarView().renderer as any)._gestureController;\n    this._isGestureListener = isMobileLikeMode(this._renderMode) || isMiniAppLikeMode(this._renderMode);\n    if (getDefaultTriggerEventByMode(this._renderMode)) {\n      // hack 应该由事件系统做？或者事件系统有更好的方式处理这种交互冲突场景\n      this._clickEnable = true;\n      this._zoomableTrigger = new (this._getTriggerEvent('trigger') as any)();\n    }\n  }\n\n  // event\n  private _getTriggerEvent(type: string): EventType {\n    return getDefaultTriggerEventByMode(this._renderMode)[type];\n  }\n\n  private _zoomEventDispatch(\n    params: BaseEventParams,\n    regionOrSeries: IRegion | ISeries,\n    callback?: (params: { zoomDelta: number; zoomX: number; zoomY: number }, e: BaseEventParams['event']) => void\n  ) {\n    if (!this._isGestureListener && !params.event) {\n      return;\n    }\n    const event = this._isGestureListener ? params : params.event.clone();\n    this._zoomableTrigger.parserZoomEvent(event);\n    // FIXME: event类型目前不全\n    const { zoomDelta, zoomX, zoomY } = event as any;\n    if (isNil(zoomDelta)) {\n      return;\n    }\n    if (\n      !pointInRect(\n        {\n          x: zoomX,\n          y: zoomY\n        },\n        this._getRegionOrSeriesLayout(regionOrSeries),\n        false\n      )\n    ) {\n      return;\n    }\n    this._clickEnable = false;\n\n    if (callback) {\n      // zoomDelta, zoomX, zoomY can be changed in the callback\n      callback({ zoomDelta, zoomX, zoomY }, event);\n    }\n    this._eventObj.emit('zoom', {\n      scale: event.zoomDelta,\n      scaleCenter: { x: event.zoomX, y: event.zoomY },\n      model: this\n    } as unknown as ExtendEventParam);\n  }\n\n  private _getRegionOrSeriesLayout(rs: IRegion | ISeries) {\n    if (rs.type !== 'region') {\n      rs = (<ISeries>rs).getRegion();\n    }\n    const { x, y, width, height } = rs.layout.getLayout();\n    return {\n      x1: x,\n      y1: y,\n      x2: x + width,\n      y2: y + height\n    };\n  }\n\n  private _bindZoomEventAsRegion(\n    eventObj: IEvent,\n    regionOrSeries: IRegion | ISeries,\n    callback?: (params: { zoomDelta: number; zoomX: number; zoomY: number }, e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) {\n    const delayType = option?.delayType ?? 'throttle';\n    const delayTime = option?.delayTime ?? 0;\n\n    const event = this._isGestureListener ? this._gestureController : eventObj;\n    const zoomParams = this._isGestureListener\n      ? [this._getTriggerEvent('zoom')]\n      : [this._getTriggerEvent('zoom'), { level: Event_Bubble_Level.chart, consume: true }];\n    const zoomEndParams: [string] | [string, EventQuery] = this._isGestureListener\n      ? [this._getTriggerEvent('zoomEnd')]\n      : [this._getTriggerEvent('zoomEnd'), { level: Event_Bubble_Level.chart, consume: false }];\n\n    // pc端没有scrollEnd事件，所以漫游模式下scroll仅支持realTime\n    (event as any).on(\n      ...zoomEndParams,\n      delayMap[delayType]((params: BaseEventParams) => {\n        this._zoomableTrigger.clearZoom();\n      }, delayTime) as any\n    );\n\n    (event as any).on(\n      ...zoomParams,\n      delayMap[delayType]((params: BaseEventParams) => {\n        // if (realTime) {\n        this._zoomEventDispatch(params, regionOrSeries, callback);\n        // }\n      }, delayTime) as any\n    );\n  }\n\n  initZoomEventOfSeries(\n    s: ISeries,\n    callback?: (params: { zoomDelta: number; zoomX: number; zoomY: number }, e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) {\n    if (this._option.disableTriggerEvent) {\n      return;\n    }\n    if (getDefaultTriggerEventByMode(this._renderMode)) {\n      this._bindZoomEventAsRegion(s.event, s, callback, option);\n    }\n  }\n\n  initZoomEventOfRegions(\n    regions: IRegion[],\n    filter?: (s: ISeries) => boolean,\n    callback?: (params: { zoomDelta: number; zoomX: number; zoomY: number }, e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) {\n    if (this._option.disableTriggerEvent) {\n      return;\n    }\n    if (getDefaultTriggerEventByMode(this._renderMode)) {\n      regions.forEach(r => {\n        if (filter) {\n          r.getSeries().forEach(s => {\n            if (filter(s)) {\n              this._bindZoomEventAsRegion(s.event, s, callback, option);\n            }\n          });\n        } else {\n          this._bindZoomEventAsRegion(this._eventObj, r, callback, option);\n        }\n      });\n    }\n  }\n\n  private _scrollEventDispatch(\n    params: BaseEventParams,\n    regionOrSeries: IRegion | ISeries,\n    callback?: (params: { scrollX: number; scrollY: number }, e: BaseEventParams['event']) => any\n  ) {\n    let stopBubble: boolean | undefined = false;\n    if (!this._isGestureListener && (!params.event || this._option.disableTriggerEvent)) {\n      return stopBubble;\n    }\n    const event = this._isGestureListener ? params : params.event;\n    this._zoomableTrigger.parserScrollEvent(event);\n    // FIXME: event类型目前不全\n    const { scrollX, scrollY, canvasX, canvasY } = event as any;\n    if (isNil(scrollX) && isNil(scrollY)) {\n      return stopBubble;\n    }\n    if (\n      !pointInRect(\n        {\n          x: canvasX,\n          y: canvasY\n        },\n        this._getRegionOrSeriesLayout(regionOrSeries),\n        false\n      )\n    ) {\n      return stopBubble;\n    }\n    this._clickEnable = false;\n\n    if (callback) {\n      stopBubble = callback({ scrollX, scrollY }, event as any);\n    }\n    this._eventObj.emit('scroll', {\n      scrollX,\n      scrollY,\n      model: this\n    } as unknown as ExtendEventParam);\n\n    return stopBubble;\n  }\n\n  private _bindScrollEventAsRegion(\n    eventObj: IEvent,\n    regionOrSeries: IRegion | ISeries,\n    callback?: (params: { scrollX: number; scrollY: number }, e: BaseEventParams['event']) => any,\n    option?: ITriggerOption\n  ) {\n    const delayType = option?.delayType ?? 'throttle';\n    const delayTime = option?.delayTime ?? 0;\n\n    const event = this._isGestureListener ? this._gestureController : eventObj;\n    const scrollParams = this._isGestureListener\n      ? [this._getTriggerEvent('scroll')]\n      : [this._getTriggerEvent('scroll'), { level: Event_Bubble_Level.chart, consume: true }];\n    const scrollEndParams = this._isGestureListener\n      ? [this._getTriggerEvent('scrollEnd')]\n      : [this._getTriggerEvent('scrollEnd'), { level: Event_Bubble_Level.chart, consume: false }];\n\n    // pc端没有scrollEnd事件，所以漫游模式下scroll仅支持realTime\n    (event as any).on(\n      ...scrollEndParams,\n      delayMap[delayType]((params: any) => {\n        this._zoomableTrigger.clearScroll();\n      }, delayTime)\n    );\n\n    (event as any).on(\n      ...scrollParams,\n      delayMap[delayType]((params: any) => {\n        // if (realTime) {\n        return this._scrollEventDispatch(params, regionOrSeries, callback);\n        // }\n      }, delayTime)\n    );\n  }\n\n  initScrollEventOfSeries(\n    s: ISeries,\n    callback?: (params: { scrollX: number; scrollY: number }, e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) {\n    if (getDefaultTriggerEventByMode(this._renderMode)) {\n      this._bindScrollEventAsRegion(s.event, s, callback, option);\n    }\n  }\n\n  initScrollEventOfRegions(\n    regions: IRegion[],\n    filter?: (s: ISeries) => boolean,\n    callback?: (params: { scrollX: number; scrollY: number }, e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) {\n    if (this._option.disableTriggerEvent) {\n      return;\n    }\n    if (getDefaultTriggerEventByMode(this._renderMode)) {\n      regions.forEach(r => {\n        if (filter) {\n          r.getSeries().forEach(s => {\n            if (filter(s)) {\n              this._bindScrollEventAsRegion(s.event, s, callback, option);\n            }\n          });\n        } else {\n          this._bindScrollEventAsRegion(this._eventObj, r, callback, option);\n        }\n      });\n    }\n  }\n\n  private _bindDragEventAsRegion(\n    eventObj: IEvent,\n    regionOrSeries: IRegion | ISeries,\n    callback?: (delta: [number, number], e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) {\n    eventObj.on(this._getTriggerEvent('start'), { level: Event_Bubble_Level.chart }, (params: any) => {\n      if (!params.event) {\n        return;\n      }\n\n      const { event } = params;\n      const shouldTrigger = pointInRect(\n        {\n          x: event.canvasX,\n          y: event.canvasY\n        },\n        this._getRegionOrSeriesLayout(regionOrSeries),\n        false\n      );\n      if (shouldTrigger) {\n        this._handleDrag(params, callback, option);\n      }\n    });\n    // click 事件需要在drag和zoom时被屏蔽\n    // hack 应该由事件系统做？或者事件系统有更好的方式处理这种交互冲突场景\n    eventObj.on('click', { level: Event_Bubble_Level.chart }, () => {\n      return !this._clickEnable;\n    });\n  }\n\n  initDragEventOfSeries(\n    s: ISeries,\n    callback?: (delta: [number, number], e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) {\n    if (this._option.disableTriggerEvent) {\n      return;\n    }\n    if (getDefaultTriggerEventByMode(this._renderMode)) {\n      s.event.on(\n        this._getTriggerEvent('start'),\n        { level: Event_Bubble_Level.model, filter: ({ model }) => model?.id === s.id },\n        params => {\n          this._handleDrag(params, callback, option);\n        }\n      );\n    }\n  }\n\n  initDragEventOfRegions(\n    regions: IRegion[],\n    filter?: (s: ISeries) => boolean,\n    callback?: (delta: [number, number], e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) {\n    if (this._option.disableTriggerEvent) {\n      return;\n    }\n    if (getDefaultTriggerEventByMode(this._renderMode)) {\n      regions.forEach(r => {\n        if (filter) {\n          r.getSeries().forEach(s => {\n            if (filter(s)) {\n              s.event.on(\n                this._getTriggerEvent('start'),\n                { level: Event_Bubble_Level.model, filter: ({ model }) => model?.id === s.id },\n                params => {\n                  this._handleDrag(params, callback);\n                }\n              );\n\n              // click 事件需要在drag和zoom时被屏蔽\n              // hack 应该由事件系统做？或者事件系统有更好的方式处理这种交互冲突场景\n              s.event.on(\n                'click',\n                { level: Event_Bubble_Level.model, filter: ({ model }) => model?.id === s.id },\n                () => {\n                  return !this._clickEnable;\n                }\n              );\n            }\n          });\n        } else {\n          this._bindDragEventAsRegion(this._eventObj, r, callback, option);\n        }\n      });\n    }\n  }\n\n  protected _handleDrag(\n    params: ExtendEventParam,\n    callback?: (delta: [number, number], e: BaseEventParams['event']) => void,\n    option?: ITriggerOption\n  ) {\n    if (this._option.disableTriggerEvent) {\n      return;\n    }\n    this._clickEnable = true;\n    if (!this._zoomableTrigger.parserDragEvent(params.event)) {\n      return;\n    }\n    const delayType = option?.delayType ?? 'throttle';\n    const delayTime = option?.delayTime ?? 0;\n    const realTime = option?.realTime ?? true;\n    const move = this._getTriggerEvent('move');\n    const end = this._getTriggerEvent('end');\n    const event = params.event;\n    let moveX = event.canvasX;\n    let moveY = event.canvasY;\n    let upX = event.canvasX;\n    let upY = event.canvasY;\n\n    const mouseup = delayMap[delayType]((params: BaseEventParams) => {\n      this._clickEnable = false;\n      const event = params.event as any;\n      const dx = event.canvasX - upX;\n      const dy = event.canvasY - upY;\n      const delta: [number, number] = [dx, dy];\n\n      upX = event.canvasX;\n      upY = event.canvasY;\n\n      if (!realTime && callback) {\n        callback(delta, params.event);\n      }\n\n      this._eventObj.emit('panend', {\n        delta,\n        model: this\n      } as unknown as BaseEventParams);\n      this._zoomableTrigger.pointerId = null;\n      this._eventObj.off(move, { level: Event_Bubble_Level.chart, source: Event_Source_Type.chart }, mousemove as any);\n      this._eventObj.off(end, { level: Event_Bubble_Level.chart, source: Event_Source_Type.window }, mouseup as any);\n    }, delayTime);\n    const mousemove = delayMap[delayType]((params: BaseEventParams) => {\n      if (!this._zoomableTrigger.parserDragEvent(params.event)) {\n        return;\n      }\n      this._clickEnable = false;\n      const event = params.event;\n      const dx = event.canvasX - moveX;\n      const dy = event.canvasY - moveY;\n      const delta: [number, number] = [dx, dy];\n\n      moveX = event.canvasX;\n      moveY = event.canvasY;\n\n      if (realTime && callback) {\n        callback(delta, params.event);\n      }\n      this._eventObj.emit('panmove', {\n        delta,\n        model: this\n      } as unknown as ExtendEventParam);\n    }, delayTime);\n\n    this._eventObj.on(move, { level: Event_Bubble_Level.chart, source: Event_Source_Type.chart }, mousemove as any);\n    this._eventObj.on(end, { level: Event_Bubble_Level.chart, source: Event_Source_Type.chart }, mouseup as any);\n  }\n}\n"]}