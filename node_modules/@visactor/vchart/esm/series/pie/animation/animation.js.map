{"version":3,"sources":["../src/series/pie/animation/animation.ts"],"names":[],"mappings":"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","file":"animation.js","sourcesContent":["import type { IElement, IAnimationTypeConfig } from '@visactor/vgrammar-core';\nimport { AnimationStateEnum } from '../../../animation/interface';\nimport type { Datum } from '../../../typings';\nimport { Factory } from '../../../core/factory';\n\nexport interface IPieAnimationParams {\n  growField?: 'angle' | 'radius';\n  growFrom: (datum: Datum, element: IElement, state: AnimationStateEnum) => number;\n}\n\nexport type PieAppearPreset = 'growAngle' | 'growRadius' | 'fadeIn';\n\n/**\n * grow生长option\n * 在appear时，所有柱子一起从同一个位置生长，需要growXXXOverall效果；\n * 在enter时，柱子应该从自身位置生长；\n * @param params\n * @param isOverall\n * @returns\n */\nexport function pieGrowOption(pieParams: IPieAnimationParams, isOverall: boolean, state: AnimationStateEnum) {\n  return (datum: Datum, element: IElement, params: AnimationStateEnum) => {\n    if (isOverall) {\n      if (pieParams.growField === 'radius') {\n        return {\n          overall: 0\n        };\n      }\n      return {\n        overall: pieParams.growFrom(datum, element, state)\n      };\n    }\n    return {\n      overall: false\n    };\n  };\n}\n\nexport const Appear_Grow = (params: IPieAnimationParams): IAnimationTypeConfig => {\n  return {\n    type: params.growField === 'radius' ? 'growRadiusIn' : 'growAngleIn',\n    options: pieGrowOption(params, true, AnimationStateEnum.appear)\n  };\n};\n\nexport const Appear_FadeIn = {\n  type: 'fadeIn'\n};\n\nexport const pieEnter = (params: IPieAnimationParams): IAnimationTypeConfig => {\n  return {\n    type: params.growField === 'radius' ? 'growRadiusIn' : 'growAngleIn',\n    easing: 'linear',\n    options: pieGrowOption(params, true, AnimationStateEnum.enter)\n  };\n};\n\nexport const pieExit = (params: IPieAnimationParams): IAnimationTypeConfig => {\n  return {\n    type: params.growField === 'radius' ? 'growRadiusOut' : 'growAngleOut',\n    easing: 'linear',\n    options: pieGrowOption(params, true, AnimationStateEnum.exit)\n  };\n};\n\nexport const pieDisappear = (params: IPieAnimationParams): IAnimationTypeConfig => {\n  return {\n    type: params.growField === 'radius' ? 'growRadiusOut' : 'growAngleOut',\n    options: pieGrowOption(params, true, AnimationStateEnum.exit)\n  };\n};\n\nexport function piePresetAnimation(params: IPieAnimationParams, preset: PieAppearPreset | boolean) {\n  if (preset === false) {\n    return {};\n  }\n  switch (preset) {\n    case 'fadeIn':\n      return Appear_FadeIn;\n    case 'growRadius':\n      return Appear_Grow({\n        ...params,\n        growField: 'radius'\n      });\n    default:\n      return Appear_Grow({\n        ...params,\n        growField: 'angle'\n      });\n  }\n}\n\nexport const registerPieAnimation = () => {\n  Factory.registerAnimation('pie', (params: IPieAnimationParams, preset: PieAppearPreset) => {\n    return {\n      appear: piePresetAnimation(params, preset),\n      enter: pieEnter(params),\n      exit: pieExit(params),\n      disappear: pieDisappear(params)\n    };\n  });\n};\n\nexport const registerPie3dAnimation = () => {\n  Factory.registerAnimation('pie3d', (params: IPieAnimationParams, preset: PieAppearPreset) => {\n    return {\n      appear: piePresetAnimation(params, preset),\n      enter: pieEnter(params),\n      exit: pieExit(params),\n      disappear: pieDisappear(params)\n    };\n  });\n};\n"]}