{"version":3,"sources":["../src/mark/arc.ts"],"names":[],"mappings":";;;AAAA,+CAA4C;AAC5C,0CAA+C;AAE/C,uCAAgD;AAEhD,gDAA4C;AAG5C,2CAAgD;AAChD,2DAA6D;AAC7D,gDAAmE;AAInE,MAAa,WAAoC,SAAQ,oBAAW;IAKlE,YAAY,IAAY,EAAE,MAAmB;QAC3C,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QALb,SAAI,GAAiB,OAAO,CAAC,IAAI,CAAC;QAE3C,sBAAiB,GAAG,EAAE,YAAY,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;QA2BrD,uBAAkB,GAAG,CAC7B,GAAW,EACX,KAAY,EACZ,SAAyB,QAAQ,EACjC,GAAQ,EACR,UAAkB,EACV,EAAE;;YACV,MAAM,MAAM,GAAG,MAAC,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,CAAY,mCAAI,CAAC,CAAC;YACtF,OAAO,UAAU,GAAG,MAAM,CAAC;QAC7B,CAAC,CAAC;QAEQ,kBAAa,GAAG,CACxB,GAAc,EACd,KAAY,EACZ,SAAyB,QAAQ,EACjC,GAAQ,EACR,MAAc,EACd,EAAE;YACF,MAAM,MAAM,GAAG,IAAA,uBAAgB,EAAC;gBAC9B,KAAK,EAAE,KAAK,CAAC,2BAAgB,CAAC;gBAC9B,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,CAAW;aACxE,CAAC,CAAC;YACH,OAAO,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;QAC9B,CAAC,CAAC;QA5CA,IAAI,CAAC,iBAAiB,CAAC,CAAC,GAAG,IAAI,CAAC,aAA8B,CAAC;QAC/D,IAAI,CAAC,iBAAiB,CAAC,CAAC,GAAG,IAAI,CAAC,aAA8B,CAAC;QAC/D,IAAI,CAAC,iBAAiB,CAAC,WAAW,GAAG,IAAI,CAAC,kBAAmC,CAAC;QAE9E,IAAI,CAAC,iBAAiB,CAAC,YAAY,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;QACjD,IAAI,CAAC,iBAAiB,CAAC,YAAY,GAAG,CAAC,aAAa,CAAC,CAAC;IACxD,CAAC;IAES,gBAAgB;QACxB,MAAM,YAAY,mCACb,KAAK,CAAC,gBAAgB,EAAE,KAC3B,UAAU,EAAE,CAAC,EACb,QAAQ,EAAE,CAAC,EACX,WAAW,EAAE,CAAC,EACd,WAAW,EAAE,CAAC,EACd,YAAY,EAAE,CAAC,EACf,SAAS,EAAE,CAAC,GACb,CAAC;QACF,OAAO,YAAY,CAAC;IACtB,CAAC;CA0BF;AAtDD,kCAsDC;AAED,MAAa,OAAQ,SAAQ,WAAyB;IAAtD;;QAEW,SAAI,GAAiB,OAAO,CAAC,IAAI,CAAC;IAC7C,CAAC;;AAHD,0BAGC;AAFiB,YAAI,GAAG,mBAAY,CAAC,GAAG,CAAC;AAInC,MAAM,eAAe,GAAG,GAAG,EAAE;IAClC,IAAA,kCAAkB,GAAE,CAAC;IACrB,IAAA,qCAA4B,GAAE,CAAC;IAC/B,iBAAO,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;AAC9C,CAAC,CAAC;AAJW,QAAA,eAAe,mBAI1B","file":"arc.js","sourcesContent":["import { Factory } from './../core/factory';\nimport { ARC_MIDDLE_ANGLE } from '../constant';\nimport type { IArcMarkSpec, Datum, StateValueType } from '../typings';\nimport { polarToCartesian } from '../util/math';\nimport type { ExChannelCall } from './base/base-mark';\nimport { BaseMark } from './base/base-mark';\nimport type { IMarkOption, IMarkRaw, IMarkStyle } from './interface';\n// eslint-disable-next-line no-duplicate-imports\nimport { MarkTypeEnum } from './interface/type';\nimport { registerArcGraphic } from '@visactor/vgrammar-core';\nimport { registerVGrammarArcAnimation } from '../animation/config';\n\nexport type IArcMark = IMarkRaw<IArcMarkSpec>;\n\nexport class BaseArcMark<T extends IArcMarkSpec> extends BaseMark<T> implements IMarkRaw<T> {\n  readonly type: MarkTypeEnum = ArcMark.type;\n\n  _unCompileChannel = { centerOffset: true, radiusOffset: true };\n\n  constructor(name: string, option: IMarkOption) {\n    super(name, option);\n\n    // because of set object.function, this setting should be write after object init\n    this._computeExChannel.x = this.computeCenter as ExChannelCall;\n    this._computeExChannel.y = this.computeCenter as ExChannelCall;\n    this._computeExChannel.outerRadius = this.computeOuterRadius as ExChannelCall;\n\n    this._extensionChannel.centerOffset = ['x', 'y'];\n    this._extensionChannel.radiusOffset = ['outerRadius'];\n  }\n\n  protected _getDefaultStyle() {\n    const defaultStyle: IMarkStyle<T> = {\n      ...super._getDefaultStyle(),\n      startAngle: 0,\n      endAngle: 0,\n      outerRadius: 0,\n      innerRadius: 0,\n      cornerRadius: 0,\n      lineWidth: 0\n    };\n    return defaultStyle;\n  }\n\n  protected computeOuterRadius = (\n    key: string,\n    datum: Datum,\n    states: StateValueType = 'normal',\n    opt: any,\n    superValue: number\n  ): number => {\n    const offset = (this.getAttribute('radiusOffset', datum, states, opt) as number) ?? 0;\n    return superValue + offset;\n  };\n\n  protected computeCenter = (\n    key: 'x' | 'y',\n    datum: Datum,\n    states: StateValueType = 'normal',\n    opt: any,\n    center: number\n  ) => {\n    const offset = polarToCartesian({\n      angle: datum[ARC_MIDDLE_ANGLE],\n      radius: this.getAttribute('centerOffset', datum, states, opt) as number\n    });\n    return center + offset[key];\n  };\n}\n\nexport class ArcMark extends BaseArcMark<IArcMarkSpec> implements IArcMark {\n  static readonly type = MarkTypeEnum.arc;\n  readonly type: MarkTypeEnum = ArcMark.type;\n}\n\nexport const registerArcMark = () => {\n  registerArcGraphic();\n  registerVGrammarArcAnimation();\n  Factory.registerMark(ArcMark.type, ArcMark);\n};\n"]}